<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>evaluation-2-projet-sql</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<h1 id="évaluation-22---b3---développement-sql-projet-sql">Évaluation
2/2 - B3 - Développement SQL : Projet SQL</h1>
<p>Date: 21/02/23</p>
<p>Auteur: Paul Schuhmacher</p>
<p>Version: 2</p>
<hr>
<ul>
<li><a
href="#évaluation-22---b3---développement-sql--projet-sql">Évaluation
2/2 - B3 - Développement SQL : Projet SQL</a>
<ul>
<li><a href="#comment-rendre-votre-travail">Comment rendre votre
travail</a></li>
<li><a href="#notation">Notation</a></li>
<li><a href="#à-rendre">À rendre</a></li>
<li><a href="#sujet">Sujet</a></li>
<li><a href="#remarques-simplifications-par-rapport-au-réel">Remarques,
simplifications par rapport au réel</a></li>
<li><a href="#conception-et-ddl-14pt">Conception et DDL (14pt)</a></li>
<li><a href="#requêtes-12pt">Requêtes (12pt)</a></li>
<li><a href="#annexes">Annexes</a>
<ul>
<li><a href="#template-de-dictionnaire-des-données">Template de
dictionnaire des données</a></li>
</ul></li>
</ul></li>
</ul>
<h2 id="comment-rendre-votre-travail">Comment rendre votre travail</h2>
<blockquote>
<p>Merci de <strong>lire attentivement</strong> les consignes !</p>
</blockquote>
<p><strong>Publier</strong> votre travail <strong>sur un dépôt git
public</strong> (GitHub, Gitlab, BitKeeper, etc.) et fournir <strong>le
lien du dépôt</strong>. Le dépôt contiendra les scripts MySQL et un
fichier <code>README</code> donnant les instructions pour installer et
utiliser votre projet.</p>
<blockquote>
<p>Penser à utiliser un <code>.gitignore</code> pour éviter de pousser
sur votre dépôt le contenu de <code>node_modules</code> et du dossier
<code>db</code> contenant le volume docker de la base de données!</p>
</blockquote>
<p>Déposez ensuite votre travail sur <strong>le devoir Teams</strong>
crée à cet effet. Voici les consignes sur le document à rendre :</p>
<ul>
<li>Document PDF, avec le nom du fichier formaté comme suit
<code>evaluation2_x_abc.pdf</code>, où <code>x</code> est la première
lettre de votre nom et <code>abc</code> votre prénom (je soumettrai donc
le sujet <code>evaluation2_s_paul.pdf</code> ). Merci d’indiquer aussi
votre nom et prénom <strong>dans le document</strong> !</li>
</ul>
<p>Dans le document PDF :</p>
<ul>
<li>Nom et prénom</li>
<li><strong>Le lien de votre dépôt Github/Gitlab qui héberge votre
projet</strong>.</li>
</ul>
<blockquote>
<p>Vous devez rendre votre travail <strong>avant la date butoir fixée
ensemble sous peine de pénalité</strong> : 1 point le premier jour de
retard, 2 points le deuxième jour de retard, et ainsi de suite jusqu’à
un minimum de 0.</p>
</blockquote>
<h2 id="notation">Notation</h2>
<p>Le projet est noté sur 30 (ramené sur 20), <strong>coefficient
2</strong>.</p>
<ul>
<li><strong>Documentation du projet</strong> : <strong>6
points</strong>. Le dépôt doit contenir un <code>README.md</code>
(Markdown) <em>bien formé</em> (<a href="#à-rendre">voir les
instructions ci-dessous</a>). Les commandes à effectuer doivent être
indiquées. Les consignes sont respectées, les scripts SQL sont
commentés. Le texte <strong>a été corrigé par un outil de correction
automatique</strong>.</li>
<li><strong>Conception (MCD)</strong> : <strong>14 points</strong>.
Modèle Conceptuel des Données bien établi et normalisé, types adéquats,
clefs bien formées, données pertinentes en lien avec le recueil des
besoins fourni en annexe. MCD <strong>lisible</strong>.</li>
<li><strong>Implémentation/Requêtes (Scripts SQL)</strong> : <strong>12
points</strong>. Votre projet doit implémenter les spécifications
demandées (<a href="#requêtes">répondre aux besoins</a>). <strong>Chaque
script SQL (fichier) doit pouvoir être exécuté en une seule
commande.</strong> Chaque requête doit être commentée.</li>
</ul>
<blockquote>
<p>Ne pas répondre à une question bonus n’est pas pénalisant. Cela
n’apporte que des points en plus.</p>
</blockquote>
<h2 id="à-rendre">À rendre</h2>
<p>L’URL de votre dépôt. Votre dépôt doit contenir <em>a minima</em>
:</p>
<ul>
<li>Un fichier <code>README.md</code> avec les sections suivantes :
<ul>
<li><strong>Table des matières</strong> (vous pouvez la générer
automatiquement), pour naviguer facilement dans le document</li>
<li><strong>Utiliser les scripts SQL</strong> : instructions pour lancer
chaque script SQL. Idéalement, je dois pouvoir copier/coller les
instructions dans l’ordre indiqué <strong>sans me poser de
questions</strong>.</li>
<li><strong>Conception</strong> :
<ul>
<li><strong>Dictionnaire des données (optionnel)</strong> : le
dictionnaire des données avec les colonnes suivantes : Libellé, Code
(nom dans le système), Type (A, N, AN, D, B), Longueur, Obligatoire (Oui
ou Non), Règle de calcul, contrainte d’intégrité, commentaire. <a
href="#template-de-dictionnaire-des-données">Voir le template avec
quelques exemples</a>. Le dictionnaire des données peut être réalisé en
Markdown ou mieux, dans <em>une feuille de classeur</em> (Excel, Libre
Office Calc)</li>
<li><strong>Le modèle conceptuel des données (MCD)</strong>, au format
png, jpeg ou svg.</li>
</ul></li>
<li><strong>Remarques (optionnel)</strong> : si vous voulez faire des
remarques sur votre travail, difficultés rencontrées, modifications
apportées, etc. C’est l’endroit pour justifier vos choix.</li>
<li><strong>Références (optionnel)</strong> : la liste des références
(sites web, cours, livre, article, billet de blog, etc.) qui vous ont
aidé à concevoir et développer votre système</li>
</ul></li>
<li>Les scripts SQL <strong>commentés</strong> (par convention on leur
donnera l’extension <code>.sql</code>) : <code>schema.sql</code>,
<code>data.sql</code> et <code>queries.sql</code></li>
</ul>
<blockquote>
<p><strong>Le dictionnaire des données n’est pas obligatoire
ici</strong>, un MCD clair et éventuellement commenté suffira. Vous êtes
encouragés à l’écrire tout de même en guise d’exercice.</p>
</blockquote>
<blockquote>
<p>Un dépôt sur le web <strong>est un site web</strong> et le fichier
<code>README.md</code> en est sa page d’accueil. <em>Soignez-le</em>
pour aider vos utilisateur·ices (et vous-même !) à (ré)utiliser votre
projet.</p>
</blockquote>
<h2 id="sujet">Sujet</h2>
<p>Vous devez modéliser une partie de la base de données de la société
Kicéo, en charge des transports en commun de Vannes. La base de données
doit permettre de mémoriser et retrouver les horaires de toutes les
lignes de bus de la ville.</p>
<p>Votre système d’information doit être capable de produire <em>à la
demande</em> les horaires d’une ligne. Par exemple, voici les horaires
de la ligne 2 aux arrêts principaux :</p>
<p><img src="./horaires-ligne-bus-2-vannes.png" width="100%"></p>
<blockquote>
<p><a
href="https://www.kiceo.fr/lignes-urbaines-kiceo/attachment/ligne-2-kiceo-2024-2/">Source
de l’image (accéder au PDF complet)</a>, téléchargeable sur <a
href="https://www.kiceo.fr">le site web de Kiceo</a></p>
</blockquote>
<h2 id="remarques-simplifications-par-rapport-au-réel">Remarques,
simplifications par rapport au réel</h2>
<ul>
<li>On ne s’intéresse pas à la mise en forme ou mise en page,
<strong>uniquement aux données</strong>;</li>
<li>On ne s’intéressera qu’à la ligne 2;</li>
<li>On ne s’intéressera qu’<em>aux arrêts principaux</em> de la ligne 2
(ceux figurant sur la fiche dans le tableau ou en gras sur le schéma de
la ligne);</li>
<li>On ne considérera <em>que les jours de la semaine</em>, pas les
samedis, dimanche et jours fériés. Plus précisément, on ne s’intéressera
qu’au lundi;</li>
<li>On se limitera aux horaires de <strong>6.32 (P+R Ouest)</strong> à
<strong>7.10 (P+R Ouest)</strong>;</li>
<li>On se limitera à la ligne 2 <strong>P+R Ouest direction
Kersec</strong>.</li>
</ul>
<h2 id="conception-et-ddl-14pt">Conception et DDL (14pt)</h2>
<ol type="1">
<li><strong>Réaliser le MCD</strong> du système d’information permettant
de répondre au besoin. Aidez-vous des entités déjà identifiées. Penser à
faire figurer les noms des associations, des cardinalités (multiplicité)
à chaque extrémité de chaque association. Vous pouvez également ajouter
des commentaires sur le schéma si nécessaire. Vous pouvez utiliser la
notation d’UML ou Merise au choix. Vous pouvez (et êtes encouragé·e)
<strong>à utiliser un logiciel de conception</strong> pour réaliser le
diagramme comme <a
href="https://www.mysql.com/products/workbench/">MySQL Workbench</a> ou
le plus modeste <a href="https://launchpad.net/analysesi">AnalyseSI</a>.
<strong>Penser à déposer une image de votre MCD</strong> (format png,
jpeg ou svg) sur le dépôt comme indiqué dans les consignes.</li>
<li><strong>Implémenter le schéma avec MySQL</strong>. <strong>Cette
étape est automatique si vous utilisez un logiciel de
conception</strong>. Apportez des modifications si nécessaire. Créer un
script <code>schema.sql</code> contenant toutes les instructions pour
générer votre base de données uniquement. Le script doit permettre de
regénérer le schéma à volonté <em>en une seule commande</em>. Fournir la
commande (avec le programme <code>mysql</code>) à executer pour
régénérer le schéma, comme indiqué dans les consignes. <em>Tip: Penser à
<code>DROP</code> les tables avant de les créer et à utiliser
<code>IF NOT EXISTS</code></em>.</li>
<li><strong>Créer un fichier <code>data.sql</code></strong> qui permet
d’insérer <strong>le jeu de données de la ligne 2</strong> (horaires aux
arrêts principaux de la ligne 2 pour les jours de semaine, etc.). Le
script doit permettre de régénérer le jeu de données à volonté <em>en
une seule commande</em>. Fournir la commande (avec le programme
<code>mysql</code>) à executer pour régénérer le jeu de données, comme
indiqué dans les consignes. <em>Tip: Penser à <code>DELETE</code> les
anciennes données lors de la régénération</em>.</li>
</ol>
<h2 id="requêtes-12pt">Requêtes (12pt)</h2>
<p>Une fois votre base conçue et contenant les données indiquées, créer
un fichier <code>queries.sql</code> contenant les requêtes SQL répondant
aux besoins suivants :</p>
<ol type="1">
<li>Afficher la table des horaires dans l’ordre chronologique à l’arrêt
<strong>Madelaine</strong>. Faire de même pour l’arrêt
<strong>République</strong>.</li>
</ol>
<p>Sorties attendues :</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">+----------------------------------------+</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">Horaires</span> à l<span class="st">&#39;arrêt Madelaine (Lundi)   |</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="st">+----------------------------------------+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="st">| 06:37:00                               |</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">| 06:47:00                               |</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="st">| 06:57:00                               |</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">| 07:06:00                               |</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">| 07:16:00                               |</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="st">+----------------------------------------+</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">+------------------------------------------+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">Horaires</span> à l<span class="st">&#39;arrêt République (Lundi)    |</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="st">+------------------------------------------+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="st">| 06:42:00                                 |</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="st">| 06:52:00                                 |</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="st">| 07:02:00                                 |</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="st">| 07:12:00                                 |</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="st">| 07:22:00                                 |</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="st">+------------------------------------------+</span></span></code></pre></div>
<ol start="2" type="1">
<li>Afficher le parcours complet de la ligne 2 <strong>Direction
Kersec</strong> (la liste des arrêts dans l’ordre de passage). <em>Tip:
Au besoin, penser à désactiver le mode <code>ONLY_FULL_GROUP_BY</code>
par défaut avec l’instruction :</em></li>
</ol>
<div class="sourceCode" id="cb3"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> sql_mode<span class="op">=</span>(<span class="kw">SELECT</span> <span class="kw">REPLACE</span>(@@sql_mode,<span class="st">&#39;ONLY_FULL_GROUP_BY&#39;</span>,<span class="st">&#39;&#39;</span>));</span></code></pre></div>
<p><em>Désactiver ce mode permet notamment d’utiliser
<code>ORDER BY</code> sur une colonne même si cette colonne n’est pas
utilisée dans le <code>GROUP BY</code>. Il vous revient la charge de
vous assurer que la valeur utilisée pour ordonner soit bien unique pour
chaque groupe, au risque d’obtenir des résultats non
déterministes.</em></p>
<p>Sortie attendue :</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">+-----------------------------------------+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">Parcours</span> de la ligne 2 Direction Kersec <span class="kw">|</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ex">+-----------------------------------------+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">P+R</span> Ouest                               <span class="kw">|</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">Fourchêne1</span>                              <span class="kw">|</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">Madelaine</span>                               <span class="kw">|</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">République</span>                              <span class="kw">|</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">PIBS</span> 2                                  <span class="kw">|</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">Petit</span> Tohannic                          <span class="kw">|</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">Delestraint</span>                             <span class="kw">|</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">Kersec</span>                                  <span class="kw">|</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="ex">+-----------------------------------------+</span></span></code></pre></div>
<ol start="3" type="1">
<li>Des travaux sont en cours dans la ville. L’arrêt <strong>Petit
Tohannic</strong> ne sera plus desservi temporairement. Un arrêt non
desservi temporairement doit indiquer l’arrêt le plus proche auquel se
rendre. On redirigera les voyageur·ses vers l’arrêt
<strong>Delestraint</strong>. <strong>Modifier le schéma de la base de
données</strong> pour modéliser ce besoin. Placer les instructions pour
modifier la base dans le fichier <code>schema.sql</code>.</li>
<li>A l’arrêt <strong>Petit Tohannic</strong>, au lien d’afficher la
table des horaires, afficher le message
<code>"Arrêt temporairement non desservi."</code>. <em>Tip: utiliser
l’instruction <a
href="https://dev.mysql.com/doc/refman/8.0/en/flow-control-functions.html#operator_case"><code>CASE</code></a>.
Voici la syntaxe générale :</em></li>
</ol>
<div class="sourceCode" id="cb5"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    colonne1,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> condition <span class="cf">THEN</span> valeur_si_vrai</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">ELSE</span> valeur_si_faux</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span> <span class="kw">AS</span> resultat</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    votre_table;</span></code></pre></div>
<ol start="5" type="1">
<li>Écrire la requête pour mettre à jour l’arrêt <strong>Petit
Tohannic</strong> et la requête pour afficher le message. Sortie
attendue :</li>
</ol>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">+------------------------------------------------------------------------------+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">Horaires</span> à l<span class="st">&#39;arrêt Petit Tohannic (Lundi)                                    |</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="st">+------------------------------------------------------------------------------+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="st">| L&#39;</span>arrêt n<span class="st">&#39;est pas desservi. Veuillez vous reporter à l&#39;</span>arrêt Delestraint.    <span class="kw">|</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="ex">+------------------------------------------------------------------------------+</span></span></code></pre></div>
<ol start="6" type="1">
<li>Ajouter la ligne 2 dans la direction opposée <strong>Direction P+R
Ouest</strong> ainsi que les stations qu’elle dessert.
<strong>Réutiliser les mêmes horaires que pour l’autre direction. On se
limitera ici a un seul trajet de bus, le premier de la
journée.</strong>.</li>
<li>Afficher pour chaque ligne, le parcours complet (liste des arrêts
dans l’ordre de passage). On y indiquera également les arrêts
temporairement non desservis. <em>Tip: Utiliser la fonction <a
href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_group-concat"><code>GROUP_CONCAT</code></a></em>.</li>
</ol>
<p>Sortie attendue :</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">+-----------------------+--------------------------------------------------------------------------------------+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">Ligne</span>                 <span class="kw">|</span> <span class="ex">Arrêts</span> desservis                                                                     <span class="kw">|</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="ex">+-----------------------+--------------------------------------------------------------------------------------+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">2</span> Direction Kersec    <span class="kw">|</span> <span class="ex">P+R</span> Ouest,Fourchêne1,Madelaine,République,PIBS 2,Petit Tohannic,Delestraint,Kersec   <span class="kw">|</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">2</span> Direction P+R Ouest <span class="kw">|</span> <span class="ex">Kersec,Delestraint,Petit</span> Tohannic,PIBS 2,République,Madelaine,Fourchêne1,P+R Ouest   <span class="kw">|</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="ex">+-----------------------+--------------------------------------------------------------------------------------+</span></span></code></pre></div>
<ol start="8" type="1">
<li><p>Durant le cours nous avons évoqué les indexs mais n’avons pas
abordé comment ils sont fabriqués et comment ils améliorent la lecture
dans une base de données. Réaliser un mini travail de veille sur <a
href="https://dev.mysql.com/doc/refman/8.0/en/optimization-indexes.html">l’utilisation
des indexs dans une base de données MySQL</a>. <strong>Présenter en
quelques lignes</strong> : le principe de fonctionnement et la
différence entre un index de type <em>B-Tree</em> et <em>Hash</em>. Vous
pouvez vous aider d’un schéma. (<strong>3pt</strong>)</p></li>
<li><p>Étant donnés les besoins actuels sur votre base, et d’après sa
structure, sur quelles colonnes serait-il judicieux de créer des indexs
? Pourquoi ?</p></li>
<li><p><strong>Écrire une procédure stockée</strong>
<code>insert_schedule(time_start ,time_end, step)</code> permettant
d’insérer des horaires, minute par minute dans une table
<code>schedule</code>. Sortie attendue :</p></li>
</ol>
<div class="sourceCode" id="cb8"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CALL</span> insert_schedule(<span class="st">&#39;06:32&#39;</span>, <span class="st">&#39;06:41&#39;</span>, <span class="st">&#39;0:01&#39;</span>);</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> horaires <span class="kw">FROM</span> schedule:</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span><span class="co">----------+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>| horaires |</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="op">+</span><span class="co">----------+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>| <span class="dv">06</span><span class="ch">:32:00</span> |</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>| <span class="dv">06</span><span class="ch">:33:00</span> |</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>| <span class="dv">06</span><span class="ch">:34:00</span> |</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>| <span class="dv">06</span><span class="ch">:35:00</span> |</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>| <span class="dv">06</span><span class="ch">:36:00</span> |</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>| <span class="dv">06</span><span class="ch">:37:00</span> |</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>| <span class="dv">06</span><span class="ch">:38:00</span> |</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>| <span class="dv">06</span><span class="ch">:39:00</span> |</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>| <span class="dv">06</span><span class="ch">:40:00</span> |</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>| <span class="dv">06</span><span class="ch">:41:00</span> |</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="op">+</span><span class="co">----------+</span></span></code></pre></div>
<h2 id="annexes">Annexes</h2>
<h3 id="template-de-dictionnaire-des-données">Template de dictionnaire
des données</h3>
<p>Voici un template de dictionnaire des données avec quelques
exemples.</p>
<table style="width:100%;">
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="header">
<th>Libellé</th>
<th>Code</th>
<th>Type</th>
<th>Longueur</th>
<th>Obligatoire ?</th>
<th>Regle de calcul/Contrainte/Commentaire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Date de commande</td>
<td>date</td>
<td>D</td>
<td>6</td>
<td>Oui</td>
<td>Format jjmmaa, jj de 01 à 31, mm de 01 à 12</td>
</tr>
<tr class="even">
<td>Quantité commandée</td>
<td>qtite</td>
<td>N</td>
<td>3</td>
<td>Oui</td>
<td>&gt; 0</td>
</tr>
<tr class="odd">
<td>Rue du client</td>
<td>rue_cli</td>
<td>AN</td>
<td>30</td>
<td>Oui</td>
<td></td>
</tr>
<tr class="even">
<td>Ville du client</td>
<td>ville_cli</td>
<td>A</td>
<td>30</td>
<td>Oui</td>
<td></td>
</tr>
<tr class="odd">
<td>Code postal du client</td>
<td>cp_cli</td>
<td>AN</td>
<td>5</td>
<td>Oui</td>
<td></td>
</tr>
<tr class="even">
<td>Adresse du client</td>
<td>adresse_cli</td>
<td>60</td>
<td>30</td>
<td>Oui</td>
<td>adresse_cli = rue_cli + ville_cli + cp_cli</td>
</tr>
<tr class="odd">
<td>Numéro de téléphone fixe du client</td>
<td>tel_dom_cli</td>
<td>AN</td>
<td>14</td>
<td>Non</td>
<td></td>
</tr>
</tbody>
</table>
<p>Remarques :</p>
<ul>
<li><p>La colonne <strong>Longueur</strong> indique la taille de la
donnée en octet/byte. Un caractère (ASCII) est généralement encodé sur
un octet. Pour un entier, cela indiquera le nombre d’octets sur lequel
il est encodé. Un entier de longueur 1 permet de créer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msup><mn>8</mn><mn>1</mn></msup></msup><mo>=</mo><mn>256</mn></mrow><annotation encoding="application/x-tex">2^8^1=256</annotation></semantics></math>
codes, donc de 0 à 255. En MySQL, c’est un <code>TINYINT</code>. Un
entier de longueur 4 permet de créer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msup><mn>8</mn><mn>4</mn></msup></msup><mo>=</mo><mn>4294967296</mn></mrow><annotation encoding="application/x-tex">2^8^4=4294967296</annotation></semantics></math>
codes, donc de 0 à 4294967295. En MySQL, c’est un
<code>INT</code>.</p></li>
<li><p>Type : <strong>A</strong>lphabétique, <strong>N</strong>umérique,
<strong>A</strong>lpha<strong>N</strong>umérique,
<strong>B</strong>ooléen, <strong>D</strong>ate</p></li>
<li><p><code>adresse_cli = rue_cli + ville_cli + cp_cli</code> indique
que <code>adresse_cli</code> est calculée à partir de
<code>rue_cli</code>, <code>ville_cli</code> et
<code>cp_cli</code>.</p></li>
</ul>
</body>
</html>
